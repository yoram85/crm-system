# CRM System - מערכת ניהול לקוחות בעברית 🇮🇱

מערכת CRM מקצועית ומלאה בעברית עם תמיכה מלאה ב-RTL, עיצוב רספונסיבי, ומסד נתונים בענן.

## ✨ תכונות עיקריות

### 📊 ניהול לקוחות
- ניהול מלא של לקוחות ולידים
- מעקב אחר סטטוס הלקוח (פעיל, לא פעיל, ליד)
- תמונות פרופיל ומידע מפורט
- הערות וחיפוש מתקדם
- פעולות מרובות (Bulk Actions)

### 💼 ניהול עסקאות
- מעקב אחר הזדמנויות מכירה
- שלבי עסקה (ליד, הצעה, משא ומתן, נסגר, נכשל)
- חישוב אחוזי הצלחה
- תאריכי סגירה צפויים
- קישור למוצרים ושירותים

### ✅ ניהול משימות
- יצירת משימות ופעילויות
- עדיפויות (נמוכה, בינונית, גבוהה)
- תאריכי יעד ומעקב סטטוס
- קישור ללקוחות ועסקאות

### 🛍️ מוצרים ושירותים
- קטלוג מוצרים עם מלאי
- ניהול שירותים עם משכי זמן
- קטגוריות ותמונות
- תמחור גמיש

### 👥 ניהול צוות
- תפקידים: מנהל, מנהל מכירות, נציג מכירות, תמיכה, צופה
- מערכת הרשאות מפורטת
- מעקב ביצועים לכל משתמש
- פיד פעילויות בזמן אמת
- יעדים חודשיים ומטריקות

### 📈 דוחות וניתוח
- לוח בקרה עם סטטיסטיקות בזמן אמת
- גרפים ותרשימים (Recharts)
- ייצוא ל-PDF עם תמיכה מלאה בעברית
- דוחות לקוחות, עסקאות, משימות

### 🔗 Webhooks ואינטגרציות
- שליחת אירועים אוטומטית ל-Webhooks
- תמיכה ב-N8N, Zapier, Make
- אינטגרציות Google Sheets ו-Airtable
- ניטור סטטוס וטיפול בשגיאות

### 🌙 Dark Mode
- מצב כהה מלא עם Tailwind
- שמירת העדפות משתמש
- מעבר חלק בין מצבים

### 🔐 אבטחה ואימות
- מערכת הרשאות מבוססת תפקידים (RBAC)
- Row Level Security ב-Supabase
- אימות מאובטח עם Supabase Auth
- הגנה על מסלולים (Protected Routes)

## 🚀 התקנה מהירה

### דרישות מוקדמות
- Node.js 18+
- חשבון Supabase (חינמי)
- חשבון Netlify (חינמי) - אופציונלי לפריסה

### 1. הורד את הפרויקט

```bash
git clone https://github.com/your-username/crm-system.git
cd crm-system
```

### 2. התקן תלויות

```bash
npm install
```

### 3. הגדר Supabase

עקוב אחר ההוראות המפורטות בקובץ [SUPABASE_SETUP.md](./SUPABASE_SETUP.md) כדי:
- ✅ ליצור פרויקט Supabase חדש
- ✅ להריץ את סקריפט ה-SQL
- ✅ לקבל את המפתחות שלך

### 4. הגדר משתני סביבה

צור קובץ `.env.local` בשורש הפרויקט:

```env
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key-here
VITE_BACKEND_URL=/.netlify/functions
```

**איפה למצוא את המפתחות?**
1. היכנס ל-[Supabase Dashboard](https://app.supabase.com)
2. בחר את הפרויקט שלך
3. לך ל-Settings > API
4. העתק את `URL` ו-`anon/public key`

### 5. הרץ את האפליקציה

```bash
npm run dev
```

האפליקציה תרוץ ב-http://localhost:5173

## 📱 פריסה ל-Netlify

### 1. חבר את הפרויקט ל-GitHub

```bash
git add .
git commit -m "Initial commit"
git branch -M main
git remote add origin https://github.com/your-username/crm-system.git
git push -u origin main
```

### 2. פרוס ל-Netlify

1. היכנס ל-[Netlify](https://app.netlify.com)
2. לחץ על "Add new site" > "Import an existing project"
3. בחר את הפרויקט שלך מ-GitHub
4. הגדר:
   - **Build command**: `npm run build`
   - **Publish directory**: `dist`
5. לחץ על "Show advanced" והוסף משתני סביבה:
   - `VITE_SUPABASE_URL` = ה-URL שלך מ-Supabase
   - `VITE_SUPABASE_ANON_KEY` = המפתח שלך מ-Supabase
   - `VITE_BACKEND_URL` = `/.netlify/functions`
6. לחץ "Deploy"

🎉 **האתר שלך באוויר!** - תוכל לגשת אליו מכל מכשיר

## 🛠️ פקודות זמינות

```bash
# פיתוח מקומי
npm run dev

# בנייה לפרודקשן
npm run build

# תצוגה מקדימה של build
npm run preview

# בדיקת קוד (Linting)
npm run lint
```

## 📚 מבנה הפרויקט

```
crm-system/
├── src/
│   ├── components/         # קומפוננטות React
│   │   ├── Layout.tsx     # Layout ראשי עם sidebar
│   │   ├── ProtectedRoute.tsx  # הגנה על routes
│   │   └── PermissionGuard.tsx # בקרת הרשאות
│   ├── pages/             # דפי האפליקציה
│   │   ├── Dashboard.tsx  # לוח בקרה
│   │   ├── Customers.tsx  # ניהול לקוחות
│   │   ├── Deals.tsx      # ניהול עסקאות
│   │   ├── Tasks.tsx      # ניהול משימות
│   │   ├── Products.tsx   # ניהול מוצרים
│   │   ├── Services.tsx   # ניהול שירותים
│   │   ├── TeamManagement.tsx    # ניהול צוות
│   │   ├── ActivityFeed.tsx      # פיד פעילויות
│   │   ├── TeamPerformance.tsx   # ביצועי צוות
│   │   ├── Reports.tsx    # דוחות
│   │   ├── Settings.tsx   # הגדרות
│   │   ├── Login.tsx      # התחברות
│   │   └── Register.tsx   # הרשמה
│   ├── store/             # ניהול State (Zustand)
│   │   ├── useStore.ts    # Store ראשי
│   │   └── useAuthStore.ts # Store אימות
│   ├── lib/               # ספריות וקונפיגורציות
│   │   └── supabase.ts    # Supabase client
│   ├── utils/             # פונקציות עזר
│   │   ├── pdfExport.ts   # ייצוא PDF
│   │   ├── hebrewFont.ts  # פונט עברי ל-PDF
│   │   ├── integrations.ts # Webhooks
│   │   └── permissions.ts  # מערכת הרשאות
│   ├── types/             # TypeScript types
│   │   └── index.ts
│   ├── App.tsx            # קומפוננטה ראשית
│   └── main.tsx           # Entry point
├── supabase-schema.sql    # סכמת מסד הנתונים
├── SUPABASE_SETUP.md      # מדריך Supabase מפורט
├── .env.local.example     # דוגמת משתני סביבה
└── README.md              # המדריך הזה
```

## 🔧 טכנולוגיות

- **Frontend**: React 18 + TypeScript
- **Build Tool**: Vite
- **Styling**: Tailwind CSS (RTL Support)
- **State Management**: Zustand
- **Routing**: React Router v6
- **Database**: Supabase (PostgreSQL)
- **Authentication**: Supabase Auth
- **Hosting**: Netlify
- **Icons**: Lucide React
- **Charts**: Recharts
- **PDF**: jsPDF + jsPDF-AutoTable
- **Dates**: date-fns

## 👤 משתמשי ברירת מחדל

לאחר הרשמה ראשונה, תוכל להתחבר עם:

**מנהל ראשי:**
- Email: admin@crm.com
- Password: admin123
- תפקיד: Admin (גישה מלאה)

**נציג מכירות:**
- Email: sales@crm.com
- Password: sales123
- תפקיד: Sales

**צופה:**
- Email: viewer@crm.com
- Password: viewer123
- תפקיד: Viewer (צפייה בלבד)

> **הערה:** משתמשים אלו קיימים רק במצב פיתוח. בפרודקשן תצטרך ליצור משתמשים ב-Supabase Auth.

## 🔐 מערכת הרשאות

### תפקידים זמינים

| תפקיד | רמת גישה | הרשאות |
|-------|---------|---------|
| **Admin** | 5 | גישה מלאה לכל הפונקציות |
| **Manager** | 4 | ניהול צוות, דוחות, הגדרות |
| **Sales** | 3 | CRUD ללקוחות, עסקאות, משימות |
| **Support** | 2 | צפייה ועריכה מוגבלת |
| **Viewer** | 1 | צפייה בלבד |

### הרשאות מפורטות

```typescript
'customers.view' | 'customers.create' | 'customers.edit' | 'customers.delete'
'deals.view' | 'deals.create' | 'deals.edit' | 'deals.delete'
'tasks.view' | 'tasks.create' | 'tasks.edit' | 'tasks.delete'
'products.view' | 'products.create' | 'products.edit' | 'products.delete'
'reports.view' | 'reports.export'
'team.view' | 'team.manage'
'settings.view' | 'settings.edit'
```

## 📊 מסד נתונים (Supabase)

### טבלאות ראשיות

- **customers** - נתוני לקוחות
- **deals** - עסקאות
- **tasks** - משימות
- **products** - מוצרים
- **services** - שירותים
- **user_profiles** - פרופילי משתמשים
- **activities** - לוג פעילויות

### אבטחה (Row Level Security)

כל טבלה מוגנת עם RLS policies המבטיחות:
- משתמשים רואים רק את הנתונים שלהם
- מניעת גישה לא מורשית
- בידוד מלא בין משתמשים

## 🔗 Webhooks & אינטגרציות

### תמיכה ב-Webhooks

המערכת שולחת אוטומטית אירועים ל-Webhooks שהגדרת:

```json
{
  "event": "customer.created",
  "timestamp": "2024-01-15T10:30:00Z",
  "data": {
    "id": "123",
    "name": "John Doe",
    "email": "john@example.com"
    // ... שאר הנתונים
  }
}
```

**פלטפורמות נתמכות:**
- ✅ N8N
- ✅ Zapier
- ✅ Make (Integromat)
- ✅ כל webhook endpoint אחר

### אינטגרציות מובנות

- **Google Sheets** - סנכרון אוטומטי לגיליונות
- **Airtable** - סנכרון למסדי נתונים Airtable

## 📄 ייצוא PDF בעברית

המערכת תומכת בייצוא מלא ל-PDF עם:
- ✅ תמיכה מלאה בעברית (פונט Rubik)
- ✅ RTL אוטומטי
- ✅ טבלאות מעוצבות
- ✅ לוגו וכותרות
- ✅ דוחות: לקוחות, עסקאות, משימות, מוצרים

## 🎨 עיצוב RTL

המערכת מותאמת במלואה לעברית:
- כיווניות RTL בכל האפליקציה
- פונטים מותאמים לעברית
- סמלים ואייקונים בצד ימין
- תפריטים נפתחים משמאל לימין
- עיצוב רספונסיבי לכל המסכים

## 🐛 פתרון בעיות

### הבעיה: לא מצליח להתחבר ל-Supabase

**פתרון:**
1. בדוק ש-`.env.local` קיים ומכיל את המפתחות הנכונים
2. ודא ש-URL מתחיל ב-`https://`
3. נסה להריץ `npm run dev` מחדש
4. בדוק ב-Network tab (F12) שאין שגיאות CORS

### הבעיה: טבלאות לא קיימות

**פתרון:**
1. היכנס ל-Supabase Dashboard
2. לך ל-SQL Editor
3. הרץ את הקובץ `supabase-schema.sql` במלואו
4. ודא שכל הטבלאות נוצרו (Table Editor > Tables)

### הבעיה: שגיאות Authentication

**פתרון:**
1. ודא ש-Email confirmation מופעלת ב-Supabase (Authentication > Settings)
2. בדוק ש-RLS policies מוגדרות נכון
3. נסה logout/login מחדש

### הבעיה: שגיאות DB2 SQL Parser ב-VS Code

**תיאור:** מוצגות שגיאות אדומות בקבצי SQL (supabase-schema.sql, create-admin.sql)

**פתרון:**
- השגיאות **לא קריטיות** - הקבצים עובדים מצוין ב-Supabase!
- VS Code מנסה לפרס PostgreSQL SQL עם parser של DB2
- הקבצים מוגדרים כ-plaintext ב-`.vscode/settings.json`
- אם השגיאות עדיין מופיעות: Ctrl+Shift+P > "Developer: Reload Window"

קרא עוד ב-[README-SQL.md](./README-SQL.md)

### הבעיה: PDF לא נפתח או עברית הפוכה

**פתרון:**
המערכת כבר מטפלת בזה! הפונט העברי (Rubik) והאלגוריתם RTL כלולים.
אם עדיין יש בעיה:
1. נקה cache של הדפדפן
2. ודא שהקובץ `src/utils/hebrewFont.ts` קיים
3. נסה להוריד את ה-PDF במקום לפתוח בדפדפן

## 🤝 תרומה לפרויקט

רוצה לתרום? מעולה!

1. Fork את הפרויקט
2. צור branch חדש (`git checkout -b feature/amazing-feature`)
3. Commit את השינויים (`git commit -m 'Add amazing feature'`)
4. Push ל-branch (`git push origin feature/amazing-feature`)
5. פתח Pull Request

## 📝 רישיון

MIT License - ראה [LICENSE](LICENSE) לפרטים נוספים.

## 🙏 תודות

- [Supabase](https://supabase.com) - Backend as a Service מדהים
- [Tailwind CSS](https://tailwindcss.com) - Framework CSS מעולה
- [Lucide](https://lucide.dev) - אייקונים יפים
- [Recharts](https://recharts.org) - גרפים ב-React
- [jsPDF](https://github.com/parallax/jsPDF) - יצירת PDF

## 📞 יצירת קשר

יש שאלות? פנה אלינו:
- 📧 Email: support@crm.com
- 🌐 Website: https://your-site.netlify.app
- 💬 GitHub Issues: [פתח issue](https://github.com/your-username/crm-system/issues)

---

**נבנה עם ❤️ בישראל 🇮🇱**

מערכת CRM מלאה בעברית - ניהול לקוחות, עסקאות, משימות ועוד!
